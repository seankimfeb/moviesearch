<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link href="searchstyles.css" rel="stylesheet" type="text/css">
</head>
<body>
    <a th:href="@{/}" class="logo">SK Movie Search</a>
    <div class="search-form">
        <form method="POST" action="/searchmovie" class="search">
            <input type="text" name="movie1" placeholder="Enter movie name..." required/>
            <input type="submit" value="Search"/>
        </form>
    </div>

    

    <div class="sort-dropdown">
        <select id="sort-options" onchange="sortResults()">
            <option value="" disabled selected>Sort By</option>
            <option value="title">Title</option>
            <option value="year">Year</option>
        </select>
    </div>

    <div id="results" th:if="${searchresult != null}">
        <th:block th:each="result : ${searchresult}">
            <div class="result-container">
                <a th:href="@{/moviedetail(id=${result.imdbID})}">
                    <img th:src="${result.poster}" alt="Movie Poster"/>
                </a>
                <div class="result-details">
                    <p><strong>Title:</strong> <span th:text="${result.title}"></span></p>
                    <p><strong>Year:</strong> <span th:text="${result.year}"></span></p>
                    <p><strong>IMDB ID:</strong> <span th:text="${result.imdbID}"></span></p>
                </div>
            </div>
            <hr/>
        </th:block>
    </div>

    <script>
        function sortResults() {
            var sortBy = document.getElementById('sort-options').value;
            var results = document.getElementById('results');
            var resultsArray = Array.from(results.getElementsByClassName('result-container'));

            if (sortBy === 'title') {
                resultsArray.sort(function(a, b) {
                    return a.querySelector('.result-details span').innerText.localeCompare(b.querySelector('.result-details span').innerText);
                });
            } else if (sortBy === 'year') {
                resultsArray.sort(function(a, b) {
                    return a.querySelector('.result-details span:nth-child(2)').innerText - b.querySelector('.result-details span:nth-child(2)').innerText;
                });
            }

            results.innerHTML = '';
            resultsArray.forEach(function(result) {
                results.appendChild(result);
            });
        }
    </script>
</body>
</html>
